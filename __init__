import requests
from lxml import etree
import cv2

def getMoviePosterImg(title):
    url = 'https://www.movieposterdb.com/search?q=' + title
    res = requests.get(url)
    content = res.content.decode()
    html = etree.HTML(content)
    xpath = '/html/body/div[1]/div/div/div[1]/div[3]//img[contains(@data-src,".jpg")]'
    
    imgs = html.xpath(xpath)
    if len(imgs) == 0:
        return []
    
    imurl = imgs[0].get('data-src')
    print(imurl)
    
    img = requests.get(imurl)
    with open("test.jpg", "wb") as file:
        file.write(img.content)
    
    img = cv2.imread('test.jpg')
    img = cv2.cvtColor(img, cv2.COLOR_BGR2RGB)  # 將 BGR 轉換為 RGB
    return img
